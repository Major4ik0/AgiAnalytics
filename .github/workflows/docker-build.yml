name: Build Windows Executable

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build-win7-x86:
    name: Build Windows 7 (x86)
    runs-on: windows-2019

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Python 3.8.10 (x86)
        uses: actions/setup-python@v5
        with:
          python-version: '3.8.10'
          architecture: x86

      - name: Install dependencies for Windows 7 (x86)
        run: |
          python -m pip install --upgrade pip==20.3.4
          pip install wheel==0.34.2
          pip install setuptools==44.0.0
          pip install numpy==1.19.3
          pip install pandas==1.3.5
          pip install PyQt5==5.15.4
          pip install pyinstaller==5.0.1
          pip install openpyxl==3.0.9
          pip install xlrd==2.0.1
          pip install pillow==8.4.0

      - name: Create custom spec file for Windows 7
        run: |
          $specContent = @"
          # -*- mode: python ; coding: utf-8 -*-
          a = Analysis(
              ['main.py'],
              pathex=[],
              binaries=[],
              datas=[],
              hiddenimports=[
                  'PyQt5', 'PyQt5.QtCore', 'PyQt5.QtGui', 'PyQt5.QtWidgets',
                  'pandas', 'numpy', 'numpy.core._multiarray_umath',
                  'openpyxl', 'openpyxl.cell._writer', 'openpyxl.utils',
                  'sqlite3', 'PIL', 'PIL._imaging', 'PIL.Image',
                  'xlrd', 'xlrd.compdoc', 'xlrd.xlsx'
              ],
              hookspath=[],
              hooksconfig={},
              runtime_hooks=[],
              excludes=['tkinter'],
              win_no_prefer_redirects=False,
              win_private_assemblies=False,
              cipher=None,
              noarchive=False
          )
          
          # –£–±–∏—Ä–∞–µ–º –≤—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è Windows 7
          pyz = PYZ(a.pure, a.zipped_data, cipher=None)
          
          exe = EXE(
              pyz,
              a.scripts,
              a.binaries,
              a.zipfiles,
              a.datas,
              [],
              name='AgiAnalytics_Win7_x86',
              debug=False,
              bootloader_ignore_signals=False,
              strip=False,
              upx=False,
              console=False,
              disable_windowed_traceback=True,
              argv_emulation=False,
              target_arch='x86',
              codesign_identity=None,
              entitlements_file=None,
              icon=['icon.ico'] if os.path.exists('icon.ico') else None
          )
          "@
          
          Set-Content -Path "win7_spec.spec" -Value $specContent -Encoding UTF8

      - name: Build executable for Windows 7 (x86)
        run: |
          $exe_name = "AgiAnalytics_Win7_x86"
          Remove-Item -Recurse -Force dist, build -ErrorAction SilentlyContinue
          
          # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–∏—Ç–æ–Ω–æ–≤—Å–∫–∏–π –ø—É—Ç—å –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏
          $pythonPath = python -c "import sys; print(sys.executable)"
          & "$pythonPath" -m PyInstaller `
            --specpath . `
            --workpath build_win7_x86 `
            --distpath dist `
            --clean `
            --noconfirm `
            win7_spec.spec
          
          if (Test-Path "dist/$exe_name/$exe_name.exe") {
            Copy-Item "dist/$exe_name/$exe_name.exe" "dist/$exe_name.exe"
            Write-Host "‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞ –¥–ª—è Windows 7 x86"
          } else {
            Write-Error "‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ –¥–ª—è Windows 7 x86"
            Get-ChildItem -Recurse | Where-Object { $_.Name -like "*.exe" -or $_.Name -like "*.log" } | Select-Object Name, FullName
            exit 1
          }

      - name: Upload Windows 7 x86 artifact
        uses: actions/upload-artifact@v4
        with:
          name: AgiAnalytics-Win7-x86
          path: dist/AgiAnalytics_Win7_x86.exe

  build-win7-x64:
    name: Build Windows 7 (x64)
    runs-on: windows-2019

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Python 3.8.10 (x64)
        uses: actions/setup-python@v5
        with:
          python-version: '3.8.10'
          architecture: x64

      - name: Install dependencies for Windows 7 (x64)
        run: |
          python -m pip install --upgrade pip==20.3.4
          pip install wheel==0.34.2
          pip install setuptools==44.0.0
          pip install numpy==1.19.3
          pip install pandas==1.3.5
          pip install PyQt5==5.15.4
          pip install pyinstaller==5.0.1
          pip install openpyxl==3.0.9
          pip install xlrd==2.0.1
          pip install pillow==8.4.0

      - name: Create custom spec file for Windows 7 x64
        run: |
          $specContent = @"
          # -*- mode: python ; coding: utf-8 -*-
          a = Analysis(
              ['main.py'],
              pathex=[],
              binaries=[],
              datas=[],
              hiddenimports=[
                  'PyQt5', 'PyQt5.QtCore', 'PyQt5.QtGui', 'PyQt5.QtWidgets',
                  'pandas', 'numpy', 'numpy.core._multiarray_umath',
                  'openpyxl', 'openpyxl.cell._writer', 'openpyxl.utils',
                  'sqlite3', 'PIL', 'PIL._imaging', 'PIL.Image',
                  'xlrd', 'xlrd.compdoc', 'xlrd.xlsx'
              ],
              hookspath=[],
              hooksconfig={},
              runtime_hooks=[],
              excludes=['tkinter'],
              win_no_prefer_redirects=False,
              win_private_assemblies=False,
              cipher=None,
              noarchive=False
          )
          
          pyz = PYZ(a.pure, a.zipped_data, cipher=None)
          
          exe = EXE(
              pyz,
              a.scripts,
              a.binaries,
              a.zipfiles,
              a.datas,
              [],
              name='AgiAnalytics_Win7_x64',
              debug=False,
              bootloader_ignore_signals=False,
              strip=False,
              upx=False,
              console=False,
              disable_windowed_traceback=True,
              argv_emulation=False,
              target_arch='x64',
              codesign_identity=None,
              entitlements_file=None,
              icon=['icon.ico'] if os.path.exists('icon.ico') else None
          )
          "@
          
          Set-Content -Path "win7_x64_spec.spec" -Value $specContent -Encoding UTF8

      - name: Build executable for Windows 7 (x64)
        run: |
          $exe_name = "AgiAnalytics_Win7_x64"
          Remove-Item -Recurse -Force dist, build -ErrorAction SilentlyContinue
          
          $pythonPath = python -c "import sys; print(sys.executable)"
          & "$pythonPath" -m PyInstaller `
            --specpath . `
            --workpath build_win7_x64 `
            --distpath dist `
            --clean `
            --noconfirm `
            win7_x64_spec.spec
          
          if (Test-Path "dist/$exe_name/$exe_name.exe") {
            Copy-Item "dist/$exe_name/$exe_name.exe" "dist/$exe_name.exe"
            Write-Host "‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞ –¥–ª—è Windows 7 x64"
          } else {
            Write-Error "‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ –¥–ª—è Windows 7 x64"
            exit 1
          }

      - name: Upload Windows 7 x64 artifact
        uses: actions/upload-artifact@v4
        with:
          name: AgiAnalytics-Win7-x64
          path: dist/AgiAnalytics_Win7_x64.exe

  build-win10-x86:
    name: Build Windows 10 (x86)
    runs-on: windows-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Python 3.9.13 (x86)
        uses: actions/setup-python@v5
        with:
          python-version: '3.9.13'
          architecture: x86

      - name: Install dependencies for Windows 10 (x86)
        run: |
          python -m pip install --upgrade pip
          pip install numpy==1.24.3
          pip install pandas==1.5.3
          pip install PyQt5==5.15.9
          pip install pyinstaller==5.12.0
          pip install openpyxl==3.1.2
          pip install pillow==9.5.0
          pip install pywin32==306

      - name: Build executable for Windows 10 (x86)
        run: |
          $exe_name = "AgiAnalytics_Win10_x86"
          Remove-Item -Recurse -Force dist, build -ErrorAction SilentlyContinue
          
          $pythonPath = python -c "import sys; print(sys.executable)"
          & "$pythonPath" -m PyInstaller `
            --onefile `
            --windowed `
            --name="$exe_name" `
            --clean `
            --noconfirm `
            --distpath=dist `
            --workpath=build_win10_x86 `
            --specpath=specs `
            --hidden-import=PyQt5 `
            --hidden-import=PyQt5.QtCore `
            --hidden-import=PyQt5.QtGui `
            --hidden-import=PyQt5.QtWidgets `
            --hidden-import=pandas `
            --hidden-import=numpy `
            --hidden-import=numpy.core._multiarray_umath `
            --hidden-import=numpy.lib.format `
            --hidden-import=openpyxl `
            --hidden-import=openpyxl.cell._writer `
            --hidden-import=openpyxl.utils `
            --hidden-import=sqlite3 `
            --hidden-import=sqlite3.dump `
            --hidden-import=PIL `
            --hidden-import=PIL._imaging `
            --hidden-import=PIL.Image `
            --hidden-import=win32timezone `
            main.py
          
          if (Test-Path "dist/$exe_name.exe") {
            Write-Host "‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞ –¥–ª—è Windows 10 x86"
          } else {
            Write-Error "‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ –¥–ª—è Windows 10 x86"
            exit 1
          }

      - name: Upload Windows 10 x86 artifact
        uses: actions/upload-artifact@v4
        with:
          name: AgiAnalytics-Win10-x86
          path: dist/AgiAnalytics_Win10_x86.exe

  build-win10-x64:
    name: Build Windows 10 (x64)
    runs-on: windows-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Python 3.9.13 (x64)
        uses: actions/setup-python@v5
        with:
          python-version: '3.9.13'
          architecture: x64

      - name: Install dependencies for Windows 10 (x64)
        run: |
          python -m pip install --upgrade pip
          pip install numpy==1.24.3
          pip install pandas==1.5.3
          pip install PyQt5==5.15.9
          pip install pyinstaller==5.12.0
          pip install openpyxl==3.1.2
          pip install pillow==9.5.0
          pip install pywin32==306

      - name: Build executable for Windows 10 (x64)
        run: |
          $exe_name = "AgiAnalytics_Win10_x64"
          Remove-Item -Recurse -Force dist, build -ErrorAction SilentlyContinue
          
          $pythonPath = python -c "import sys; print(sys.executable)"
          & "$pythonPath" -m PyInstaller `
            --onefile `
            --windowed `
            --name="$exe_name" `
            --clean `
            --noconfirm `
            --distpath=dist `
            --workpath=build_win10_x64 `
            --specpath=specs `
            --hidden-import=PyQt5 `
            --hidden-import=PyQt5.QtCore `
            --hidden-import=PyQt5.QtGui `
            --hidden-import=PyQt5.QtWidgets `
            --hidden-import=pandas `
            --hidden-import=numpy `
            --hidden-import=numpy.core._multiarray_umath `
            --hidden-import=numpy.lib.format `
            --hidden-import=openpyxl `
            --hidden-import=openpyxl.cell._writer `
            --hidden-import=openpyxl.utils `
            --hidden-import=sqlite3 `
            --hidden-import=sqlite3.dump `
            --hidden-import=PIL `
            --hidden-import=PIL._imaging `
            --hidden-import=PIL.Image `
            --hidden-import=win32timezone `
            main.py
          
          if (Test-Path "dist/$exe_name.exe") {
            Write-Host "‚úÖ –°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞ –¥–ª—è Windows 10 x64"
          } else {
            Write-Error "‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ –¥–ª—è Windows 10 x64"
            exit 1
          }

      - name: Upload Windows 10 x64 artifact
        uses: actions/upload-artifact@v4
        with:
          name: AgiAnalytics-Win10-x64
          path: dist/AgiAnalytics_Win10_x64.exe

  create-release:
    name: Create Release Package
    needs: [build-win7-x86, build-win7-x64, build-win10-x86, build-win10-x64]
    runs-on: windows-latest
    if: github.event_name == 'push' && github.ref == 'refs/heads/main'

    steps:
      - name: Download all artifacts
        uses: actions/download-artifact@v4
        with:
          path: artifacts

      - name: Create release structure
        run: |
          New-Item -ItemType Directory -Force -Path "AgiAnalytics_v$env:GITHUB_RUN_NUMBER"
          
          # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫
          $folders = @("Windows_7_32bit", "Windows_7_64bit", "Windows_10_32bit", "Windows_10_64bit", "Dependencies")
          foreach ($folder in $folders) {
            New-Item -ItemType Directory -Force -Path "AgiAnalytics_v$env:GITHUB_RUN_NUMBER\$folder"
          }
          
          # –ö–æ–ø–∏—Ä—É–µ–º –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã
          if (Test-Path "artifacts/AgiAnalytics-Win7-x86/AgiAnalytics_Win7_x86.exe") {
            Copy-Item "artifacts/AgiAnalytics-Win7-x86/AgiAnalytics_Win7_x86.exe" "AgiAnalytics_v$env:GITHUB_RUN_NUMBER\Windows_7_32bit\"
          }
          
          if (Test-Path "artifacts/AgiAnalytics-Win7-x64/AgiAnalytics_Win7_x64.exe") {
            Copy-Item "artifacts/AgiAnalytics-Win7-x64/AgiAnalytics_Win7_x64.exe" "AgiAnalytics_v$env:GITHUB_RUN_NUMBER\Windows_7_64bit\"
          }
          
          if (Test-Path "artifacts/AgiAnalytics-Win10-x86/AgiAnalytics_Win10_x86.exe") {
            Copy-Item "artifacts/AgiAnalytics-Win10-x86/AgiAnalytics_Win10_x86.exe" "AgiAnalytics_v$env:GITHUB_RUN_NUMBER\Windows_10_32bit\"
          }
          
          if (Test-Path "artifacts/AgiAnalytics-Win10-x64/AgiAnalytics_Win10_x64.exe") {
            Copy-Item "artifacts/AgiAnalytics-Win10-x64/AgiAnalytics_Win10_x64.exe" "AgiAnalytics_v$env:GITHUB_RUN_NUMBER\Windows_10_64bit\"
          }
          
          # –°–æ–∑–¥–∞–µ–º –∑–∞–ø—É—Å–∫–∞—Ç–æ—Ä
          $launcherContent = @'
          @echo off
          chcp 65001 >nul
          echo ========================================
          echo   AgiAnalytics - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫
          echo ========================================
          echo.
          echo –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã...
          
          set OS=
          set ARCH=
          set "PROCESSOR_ARCHITECTURE=%PROCESSOR_ARCHITECTURE%"
          
          :: –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏—é Windows
          ver | findstr /i "6\.1" >nul && set OS=7
          ver | findstr /i "10\." >nul && set OS=10
          
          :: –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
          if "%PROCESSOR_ARCHITECTURE%"=="AMD64" (
              set ARCH=x64
          ) else (
              set ARCH=x86
          )
          
          echo.
          echo –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ: Windows %OS% (%ARCH%)
          echo.
          
          if "%OS%"=="7" (
              echo ‚ö†Ô∏è  –í–ê–ñ–ù–û: –î–ª—è Windows 7 —Ç—Ä–µ–±—É—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
              echo    1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ VC++ Redistributable –∏–∑ –ø–∞–ø–∫–∏ Dependencies
              echo    2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ KB2999226
              echo    3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Windows
              echo.
              echo –ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...
              pause >nul
          )
          
          :: –ó–∞–ø—É—Å–∫–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤–µ—Ä—Å–∏—é
          if exist "Windows_%OS%_%ARCH%\AgiAnalytics_Win%OS%_%ARCH%.exe" (
              echo –ó–∞–ø—É—Å–∫ AgiAnalytics_Win%OS%_%ARCH%.exe...
              start "" "Windows_%OS%_%ARCH%\AgiAnalytics_Win%OS%_%ARCH%.exe"
          ) else (
              echo ‚ùå –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: Windows_%OS%_%ARCH%\AgiAnalytics_Win%OS%_%ARCH%.exe
              echo.
              echo –î–æ—Å—Ç—É–ø–Ω—ã–µ –≤–µ—Ä—Å–∏–∏:
              dir /b Windows_* || echo –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–µ—Ä—Å–∏–π
              pause
              exit /b 1
          )
          '@
          
          Set-Content -Path "AgiAnalytics_v$env:GITHUB_RUN_NUMBER\Start_AgiAnalytics.bat" -Value $launcherContent -Encoding UTF8
          
          # –°–æ–∑–¥–∞–µ–º README
          $readmeContent = @'
          ========================================
          AgiAnalytics v${{ github.run_number }}
          ========================================
          
          –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï:
          
          1. –†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤
          2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Start_AgiAnalytics.bat
          3. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –≤–∞—à—É —Å–∏—Å—Ç–µ–º—É
          
          –í–ê–ñ–ù–û –î–õ–Ø WINDOWS 7:
          
          –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ü–ï–†–ï–î –∑–∞–ø—É—Å–∫–æ–º:
          
          1. Visual C++ Redistributable 2015-2022:
             - –î–ª—è 32-bit: vcredist_x86.exe –∏–∑ –ø–∞–ø–∫–∏ Dependencies
             - –î–ª—è 64-bit: vcredist_x64.exe –∏–∑ –ø–∞–ø–∫–∏ Dependencies
          
          2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ KB2999226 (Universal C Runtime):
             - windows6.1-kb2999226-x64.msu –¥–ª—è 64-bit
             - windows6.1-kb2999226-x86.msu –¥–ª—è 32-bit
          
          3. –í—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Windows —á–µ—Ä–µ–∑ –¶–µ–Ω—Ç—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
          
          –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–û–ö:
          
          1. –û—à–∏–±–∫–∞ "api-ms-win-core-path-l1-1-0.dll" - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ KB2999226
          2. –û—à–∏–±–∫–∞ "VCRUNTIME140.dll" - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ VC++ Redistributable
          3. –ê–Ω—Ç–∏–≤–∏—Ä—É—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç - –¥–æ–±–∞–≤—å—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
          4. –ù–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è - –∑–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
          
          –ü–û–î–î–ï–†–ñ–ö–ê:
          GitHub Issues: https://github.com/${{ github.repository }}/issues
          '@
          
          Set-Content -Path "AgiAnalytics_v$env:GITHUB_RUN_NUMBER\README.txt" -Value $readmeContent -Encoding UTF8

      - name: Create ZIP archive
        run: |
          Compress-Archive -Path "AgiAnalytics_v$env:GITHUB_RUN_NUMBER\*" -DestinationPath "AgiAnalytics_v$env:GITHUB_RUN_NUMBER.zip"
          Write-Host "‚úÖ –ê—Ä—Ö–∏–≤ —Å–æ–∑–¥–∞–Ω: AgiAnalytics_v$env:GITHUB_RUN_NUMBER.zip"

      - name: Upload release artifact
        uses: actions/upload-artifact@v4
        with:
          name: AgiAnalytics-Release
          path: AgiAnalytics_v${{ github.run_number }}.zip

      - name: Create GitHub Release
        uses: softprops/action-gh-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          files: AgiAnalytics_v${{ github.run_number }}.zip
          tag_name: v${{ github.run_number }}
          name: AgiAnalytics v${{ github.run_number }}
          body: |
            # üöÄ AgiAnalytics v${{ github.run_number }}
            
            ## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –û–®–ò–ë–ö–ò:
            
            ‚úÖ –†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å `api-ms-win-core-path-l1-1-0.dll` –Ω–∞ Windows 7  
            ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ Python DLL  
            ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Windows 7  
            ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å —Å–∏—Å—Ç–µ–º—ã  
            
            ## ‚ö° –ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨:
            
            1. –°–∫–∞—á–∞–π—Ç–µ –∞—Ä—Ö–∏–≤
            2. –†–∞—Å–ø–∞–∫—É–π—Ç–µ –≤ –ª—é–±—É—é –ø–∞–ø–∫—É
            3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ **Start_AgiAnalytics.bat**
            4. –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å–∞–º–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –≤–∞—à—É –≤–µ—Ä—Å–∏—é Windows
            
            ## ‚ö†Ô∏è –í–ê–ñ–ù–û –î–õ–Ø WINDOWS 7:
            
            –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
            
            1. **[Visual C++ Redistributable 2015-2022](https://aka.ms/vs/17/release/vc_redist.x86.exe)** (x86)  
            2. **[Visual C++ Redistributable 2015-2022](https://aka.ms/vs/17/release/vc_redist.x64.exe)** (x64)  
            3. **[–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ KB2999226](https://catalog.s.download.windowsupdate.com/c/msdownload/update/software/updt/2015/07/windows6.1-kb2999226-x86.msu)** (x86)  
            4. **[–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ KB2999226](https://catalog.s.download.windowsupdate.com/c/msdownload/update/software/updt/2015/07/windows6.1-kb2999226-x64.msu)** (x64)  
            
            ## üìä –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò:
            
            | –°–∏—Å—Ç–µ–º–∞ | Python | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ |
            |---------|--------|-------------|-------------|
            | Windows 7 | 3.8.10 | x86/x64 | –û—Ç–∫–ª—é—á–µ–Ω UPX, —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ |
            | Windows 10 | 3.9.13 | x86/x64 | –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ |
            
            ## üìÅ –°–û–î–ï–†–ñ–ò–ú–û–ï –ê–†–•–ò–í–ê:
            
            - `Windows_7_32bit/` - –¥–ª—è Windows 7 32-bit
            - `Windows_7_64bit/` - –¥–ª—è Windows 7 64-bit  
            - `Windows_10_32bit/` - –¥–ª—è Windows 10 32-bit
            - `Windows_10_64bit/` - –¥–ª—è Windows 10 64-bit
            - `Start_AgiAnalytics.bat` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫–∞—Ç–æ—Ä
            - `README.txt` - –ø–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
            
            ## üêõ –ü–û–î–î–ï–†–ñ–ö–ê:
            
            [–°–æ–æ–±—â–∏—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–µ](https://github.com/${{ github.repository }}/issues/new)