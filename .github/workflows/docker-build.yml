name: Build Windows Executable

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

permissions:
  contents: write

jobs:
  build-win7-x64:
    name: Build Universal x64 (Win7/10/11)
    runs-on: windows-2019

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Python 3.8.10 (x64)
        uses: actions/setup-python@v5
        with:
          python-version: '3.8.10'
          architecture: x64

      - name: Install dependencies for x64
        run: |
          python -m pip install --upgrade pip
          pip install numpy==1.21.6 pandas==1.3.5 PyQt5==5.15.4 pyinstaller==5.13.0 openpyxl==3.0.10 pillow==9.5.0 msoffcrypto-tool==4.12.0 olefile==0.46 xlrd==2.0.1 xlwt==1.3.0

      - name: Create resource access module
        run: |
          # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¼Ð¾Ð´ÑƒÐ»ÑŒ Ð´Ð»Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼
          $resource_module = @'
          import sys
          import os
          
          def resource_path(relative_path):
              """ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð°Ð±ÑÐ¾Ð»ÑŽÑ‚Ð½Ñ‹Ð¹ Ð¿ÑƒÑ‚ÑŒ Ðº Ñ€ÐµÑÑƒÑ€ÑÑƒ, Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð´Ð»Ñ dev Ð¸ Ð´Ð»Ñ PyInstaller"""
              try:
                  # PyInstaller ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ Ð¿Ð°Ð¿ÐºÑƒ Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ Ð¿ÑƒÑ‚ÑŒ Ð² _MEIPASS
                  base_path = sys._MEIPASS
              except Exception:
                  base_path = os.path.abspath(".")
          
              path = os.path.join(base_path, relative_path)
              
              # ÐŸÑ€Ð¾Ð±ÑƒÐµÐ¼ Ð½Ð°Ð¹Ñ‚Ð¸ Ñ„Ð°Ð¹Ð»
              if not os.path.exists(path):
                  # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð¿ÑƒÑ‚Ð¸
                  alternative_paths = [
                      path,
                      os.path.join(os.path.dirname(sys.executable), relative_path),
                      os.path.join(os.path.dirname(__file__), relative_path),
                      os.path.join(os.path.dirname(__file__), "..", relative_path),
                  ]
                  
                  for alt_path in alternative_paths:
                      if os.path.exists(alt_path):
                          return alt_path
              
              return path
          
          def get_icon_path(icon_name="icon.ico"):
              """ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¿ÑƒÑ‚ÑŒ Ðº Ð¸ÐºÐ¾Ð½ÐºÐµ"""
              icon_paths = [
                  icon_name,  # ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð¸Ð¼Ñ Ñ„Ð°Ð¹Ð»Ð°
                  f"icons/{icon_name}",  # Ð’ Ð¿Ð°Ð¿ÐºÐµ icons
                  f"../icons/{icon_name}",  # ÐÐ° ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð²Ñ‹ÑˆÐµ
                  f"../../icons/{icon_name}",  # ÐÐ° Ð´Ð²Ð° ÑƒÑ€Ð¾Ð²Ð½Ñ Ð²Ñ‹ÑˆÐµ
              ]
              
              for icon_path in icon_paths:
                  full_path = resource_path(icon_path)
                  if os.path.exists(full_path):
                      return full_path
              
              # Ð•ÑÐ»Ð¸ Ð¸ÐºÐ¾Ð½ÐºÐ° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°, Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ None
              return None
          
          def get_all_icons():
              """ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð²ÑÐµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ð¸ÐºÐ¾Ð½ÐºÐ¸"""
              icons_dir = resource_path("icons")
              icons = {}
              
              if os.path.exists(icons_dir) and os.path.isdir(icons_dir):
                  for filename in os.listdir(icons_dir):
                      if filename.endswith(('.ico', '.png', '.jpg', '.jpeg')):
                          icon_name = os.path.splitext(filename)[0]
                          icons[icon_name] = os.path.join(icons_dir, filename)
              
              return icons
          '@
          
          Set-Content -Path "resource_helper.py" -Value $resource_module -Encoding UTF8
          Write-Host "âœ… ÐœÐ¾Ð´ÑƒÐ»ÑŒ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½"

      - name: Build x64 executable
        run: |
          $exe_name = "AgiAnalytics_x64"
          Remove-Item -Recurse -Force dist, build -ErrorAction SilentlyContinue
          
          # Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ñ Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼Ð¸
          pyinstaller --onefile --windowed --icon=icons/icon.ico --name="$exe_name" --noupx --clean `
            --hidden-import=PyQt5 `
            --hidden-import=PyQt5.QtCore `
            --hidden-import=PyQt5.QtGui `
            --hidden-import=PyQt5.QtWidgets `
            --hidden-import=pandas `
            --hidden-import=numpy `
            --hidden-import=numpy.core._multiarray_umath `
            --hidden-import=openpyxl `
            --hidden-import=openpyxl.cell._writer `
            --hidden-import=openpyxl.utils `
            --hidden-import=sqlite3 `
            --hidden-import=PIL `
            --hidden-import=PIL._imaging `
            --hidden-import=PIL.Image `
            --hidden-import=xlrd `
            --hidden-import=xlrd.compdoc `
            --hidden-import=xlrd.xlsx `
            --hidden-import=xlwt `
            --hidden-import=xlwt.ExcelFormula `
            --hidden-import=xlwt.ExcelFormulaParser `
            --hidden-import=msoffcrypto `
            --hidden-import=olefile `
            --hidden-import=encodings.utf_8 `
            --hidden-import=encodings.cp1251 `
            --add-data="icons;icons" `
            --add-data="resource_helper.py;." `
            main.py
          
          if (Test-Path "dist/$exe_name.exe") {
            Write-Host "âœ… Ð¡Ð±Ð¾Ñ€ÐºÐ° x64 ÑƒÑÐ¿ÐµÑˆÐ½Ð°"
            $size = (Get-Item "dist/$exe_name.exe").Length / 1MB
            Write-Host "ðŸ“¦ Ð Ð°Ð·Ð¼ÐµÑ€ Ñ„Ð°Ð¹Ð»Ð°: $($size.ToString('0.00')) MB"
            
            # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ Ñ€ÐµÑÑƒÑ€ÑÑ‹ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ñ‹
            Write-Host "ðŸ” ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ°:"
            if (Test-Path "dist/icons") {
              Write-Host "âœ… ÐŸÐ°Ð¿ÐºÐ° icons Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð° Ð² ÑÐ±Ð¾Ñ€ÐºÑƒ"
            } else {
              Write-Host "âš ï¸  ÐŸÐ°Ð¿ÐºÐ° icons Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð° Ð² dist"
            }
          } else {
            Write-Error "âŒ ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ±Ð¾Ñ€ÐºÐ¸ x64"
            exit 1
          }

      - name: Upload x64 artifact
        uses: actions/upload-artifact@v4
        with:
          name: AgiAnalytics-x64
          path: dist/AgiAnalytics_x64.exe

  build-win7-x86:
    name: Build Legacy x86 (Win7/10/11)
    runs-on: windows-2019

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Python 3.8.10 (x86)
        uses: actions/setup-python@v5
        with:
          python-version: '3.8.10'
          architecture: x86

      - name: Install dependencies for x86
        run: |
          python -m pip install --upgrade pip==20.3.4
          pip install wheel==0.34.2 setuptools==44.0.0 numpy==1.19.3 pandas==1.3.5 PyQt5==5.15.4 pyinstaller==5.0.1 openpyxl==3.0.9 xlrd==2.0.1 xlwt==1.3.0 pillow==8.4.0 msoffcrypto-tool==4.12.0 olefile==0.46

      - name: Build x86 executable
        run: |
          $exe_name = "AgiAnalytics_x86"
          Remove-Item -Recurse -Force dist, build -ErrorAction SilentlyContinue
          
          pyinstaller --onefile --windowed --icon=icons/icon.ico --name="$exe_name" --noupx --clean `
            --add-data="icons;icons" `
            --add-data="resource_helper.py;." `
            main.py
          
          if (Test-Path "dist/$exe_name.exe") {
            Write-Host "âœ… Ð¡Ð±Ð¾Ñ€ÐºÐ° x86 ÑƒÑÐ¿ÐµÑˆÐ½Ð°"
            $size = (Get-Item "dist/$exe_name.exe").Length / 1MB
            Write-Host "ðŸ“¦ Ð Ð°Ð·Ð¼ÐµÑ€ Ñ„Ð°Ð¹Ð»Ð°: $($size.ToString('0.00')) MB"
          } else {
            Write-Error "âŒ ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ±Ð¾Ñ€ÐºÐ¸ x86"
            exit 1
          }

      - name: Upload x86 artifact
        uses: actions/upload-artifact@v4
        with:
          name: AgiAnalytics-x86
          path: dist/AgiAnalytics_x86.exe

  create-release:
    name: Create Universal Release
    needs: [build-win7-x64, build-win7-x86]
    runs-on: ubuntu-latest
    if: github.event_name == 'push' && github.ref == 'refs/heads/main'
    permissions:
      contents: write

    steps:
      - name: Download all artifacts
        uses: actions/download-artifact@v4
        with:
          path: artifacts
          pattern: AgiAnalytics-*
          merge-multiple: true

      - name: Get current date
        id: date
        run: echo "date=$(date -u +'%Y-%m-%d %H:%M:%S UTC')" >> $GITHUB_OUTPUT

      - name: Create release structure
        run: |
          version=${{ github.run_number }}
          release_name="AgiAnalytics_v$version"
          
          # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³Ð¾Ð²
          mkdir -p "$release_name/x64"
          mkdir -p "$release_name/x86"
          
          # ÐšÐ¾Ð¿Ð¸Ñ€ÑƒÐµÐ¼ Ð¸ÑÐ¿Ð¾Ð»Ð½ÑÐµÐ¼Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹
          if [ -f "artifacts/AgiAnalytics_x64.exe" ]; then
            cp "artifacts/AgiAnalytics_x64.exe" "$release_name/x64/"
            echo "âœ… x64 Ð²ÐµÑ€ÑÐ¸Ñ ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð°"
          fi
          
          if [ -f "artifacts/AgiAnalytics_x86.exe" ]; then
            cp "artifacts/AgiAnalytics_x86.exe" "$release_name/x86/"
            echo "âœ… x86 Ð²ÐµÑ€ÑÐ¸Ñ ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð°"
          fi
          
          # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð»Ð°ÑƒÐ½Ñ‡ÐµÑ€
          cat > "$release_name/Start_AgiAnalytics.bat" << 'EOF'
          @echo off
          chcp 65001 >nul
          echo ========================================
          echo   AgiAnalytics - ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð·Ð°Ð¿ÑƒÑÐº
          echo ========================================
          echo.
          
          REM ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ñƒ
          if "%PROCESSOR_ARCHITECTURE%"=="AMD64" (
              set "EXE_PATH=x64\AgiAnalytics_x64.exe"
              echo ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð° 64-Ð±Ð¸Ñ‚Ð½Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°
          ) else (
              set "EXE_PATH=x86\AgiAnalytics_x86.exe"
              echo ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð° 32-Ð±Ð¸Ñ‚Ð½Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°
          )
          
          echo.
          
          REM ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð°
          if exist "%EXE_PATH%" (
              echo Ð—Ð°Ð¿ÑƒÑÐº Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹...
              echo.
              start "" "%EXE_PATH%"
          ) else (
              echo âŒ ÐžÑˆÐ¸Ð±ÐºÐ°: Ð¤Ð°Ð¹Ð» Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½
              echo ÐŸÑƒÑ‚ÑŒ: %EXE_PATH%
              echo.
              echo ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ, Ñ‡Ñ‚Ð¾:
              echo 1. Ð’Ñ‹ Ñ€Ð°ÑÐ¿Ð°ÐºÐ¾Ð²Ð°Ð»Ð¸ Ð²ÐµÑÑŒ Ð°Ñ€Ñ…Ð¸Ð²
              echo 2. Ð¤Ð°Ð¹Ð»Ñ‹ Ð½Ð°Ñ…Ð¾Ð´ÑÑ‚ÑÑ Ð² Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ð°Ð¿ÐºÐ°Ñ…
              echo.
              pause
          )
          EOF
                    
                    # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ð¹ README
                    cat > "$release_name/README.txt" << EOF
          ========================================
          AgiAnalytics v$version
          ========================================
          
          Ð¡ÐžÐ”Ð•Ð Ð–Ð˜ÐœÐžÐ•:
          â€¢ x64/AgiAnalytics_x64.exe - 64-Ð±Ð¸Ñ‚Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ (Ð²ÑÐµ Ñ€ÐµÑÑƒÑ€ÑÑ‹ Ð²Ð½ÑƒÑ‚Ñ€Ð¸)
          â€¢ x86/AgiAnalytics_x86.exe - 32-Ð±Ð¸Ñ‚Ð½Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ (Ð²ÑÐµ Ñ€ÐµÑÑƒÑ€ÑÑ‹ Ð²Ð½ÑƒÑ‚Ñ€Ð¸)
          â€¢ Start_AgiAnalytics.bat   - ÐÐ²Ñ‚Ð¾Ð·Ð°Ð¿ÑƒÑÐº
          
          Ð˜ÐÐ¡Ð¢Ð Ð£ÐšÐ¦Ð˜Ð¯:
          1. Ð Ð°ÑÐ¿Ð°ÐºÑƒÐ¹Ñ‚Ðµ Ð°Ñ€Ñ…Ð¸Ð² Ð² Ð»ÑŽÐ±ÑƒÑŽ Ð¿Ð°Ð¿ÐºÑƒ
          2. Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Start_AgiAnalytics.bat
          3. ÐŸÑ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð° ÑÐ°Ð¼Ð° Ð²Ñ‹Ð±ÐµÑ€ÐµÑ‚ Ð½ÑƒÐ¶Ð½ÑƒÑŽ Ð²ÐµÑ€ÑÐ¸ÑŽ
          
          ÐžÐ¡ÐžÐ‘Ð•ÐÐÐžÐ¡Ð¢Ð˜:
          â€¢ Ð’ÑÐµ Ð¸ÐºÐ¾Ð½ÐºÐ¸ ÑƒÐ¿Ð°ÐºÐ¾Ð²Ð°Ð½Ñ‹ Ð²Ð½ÑƒÑ‚Ñ€ÑŒ EXE Ñ„Ð°Ð¹Ð»Ð°
          â€¢ ÐÐµ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²
          â€¢ ÐÐ²Ñ‚Ð¾Ð½Ð¾Ð¼Ð½Ð°Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð°
          
          Ð”Ð›Ð¯ WINDOWS 7:
          Ð•ÑÐ»Ð¸ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð° Ð½Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ:
          1. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ KB2999226
          2. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Visual C++ Redistributable
          3. ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ ÐºÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€
          
          ÐŸÐžÐ”Ð”Ð•Ð Ð–ÐšÐ:
          https://github.com/${{ github.repository }}/issues
          
          Ð”Ð°Ñ‚Ð° ÑÐ±Ð¾Ñ€ÐºÐ¸: ${{ steps.date.outputs.date }}
          EOF

      - name: Create ZIP archive
        run: |
          version=${{ github.run_number }}
          release_name="AgiAnalytics_v$version"
          zip -r "${release_name}.zip" "$release_name"
          echo "âœ… ÐÑ€Ñ…Ð¸Ð² ÑÐ¾Ð·Ð´Ð°Ð½: ${release_name}.zip"

      - name: Upload release artifact
        uses: actions/upload-artifact@v4
        with:
          name: AgiAnalytics-Release
          path: AgiAnalytics_v${{ github.run_number }}.zip

      - name: Create GitHub Release
        uses: softprops/action-gh-release@v1
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          files: AgiAnalytics_v${{ github.run_number }}.zip
          tag_name: v${{ github.run_number }}
          name: AgiAnalytics v${{ github.run_number }}
          body: |
            ## ðŸš€ Ð£Ð½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ð°Ñ ÑÐ±Ð¾Ñ€ÐºÐ° Ð´Ð»Ñ Windows
            
            ### ðŸ“¦ Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ:
            - **x64/AgiAnalytics_x64.exe** - Ð´Ð»Ñ 64-Ð±Ð¸Ñ‚Ð½Ñ‹Ñ… ÑÐ¸ÑÑ‚ÐµÐ¼
            - **x86/AgiAnalytics_x86.exe** - Ð´Ð»Ñ 32-Ð±Ð¸Ñ‚Ð½Ñ‹Ñ… ÑÐ¸ÑÑ‚ÐµÐ¼
            - **Start_AgiAnalytics.bat** - Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð²Ñ‹Ð±Ð¾Ñ€ Ð²ÐµÑ€ÑÐ¸Ð¸
            
            ### âš¡ ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸:
            - âœ… Ð’ÑÐµ Ñ€ÐµÑÑƒÑ€ÑÑ‹ ÑƒÐ¿Ð°ÐºÐ¾Ð²Ð°Ð½Ñ‹ Ð²Ð½ÑƒÑ‚Ñ€ÑŒ EXE
            - âœ… ÐÐµ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²
            - âœ… ÐÐ²Ñ‚Ð¾Ð½Ð¾Ð¼Ð½Ð°Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð°
            - âœ… Ð˜ÐºÐ¾Ð½ÐºÐ¸ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ñ‹ Ð² Ð¸ÑÐ¿Ð¾Ð»Ð½ÑÐµÐ¼Ñ‹Ð¹ Ñ„Ð°Ð¹Ð»
            
            ### ðŸš€ Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ ÑÑ‚Ð°Ñ€Ñ‚:
            1. Ð¡ÐºÐ°Ñ‡Ð°Ð¹Ñ‚Ðµ Ð°Ñ€Ñ…Ð¸Ð²
            2. Ð Ð°ÑÐ¿Ð°ÐºÑƒÐ¹Ñ‚Ðµ Ð² Ð»ÑŽÐ±ÑƒÑŽ Ð¿Ð°Ð¿ÐºÑƒ
            3. Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ `Start_AgiAnalytics.bat`
            
            ### ðŸ”§ Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ:
            - Windows 7 SP1 Ð¸Ð»Ð¸ Ð½Ð¾Ð²ÐµÐµ
            - 2 Ð“Ð‘ ÐžÐ—Ð£ (Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ 4 Ð“Ð‘)
            - 100 ÐœÐ‘ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð¼ÐµÑÑ‚Ð°
            
            ### ðŸ› ï¸ Ð”Ð»Ñ Windows 7:
            Ð•ÑÐ»Ð¸ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð° Ð½Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ, ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ:
            1. [ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ KB2999226](https://support.microsoft.com/en-us/topic/update-for-universal-c-runtime-in-windows-c0514201-7fe6-95a3-b0a5-287930f3560c)
            2. [Visual C++ Redistributable](https://aka.ms/vs/17/release/vc_redist.x64.exe)
            
            ### ðŸ“ Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ ÑÐ±Ð¾Ñ€ÐºÐµ:
            - Ð’ÐµÑ€ÑÐ¸Ñ Python: 3.8.10
            - PyInstaller: 5.13.0 (x64) / 5.0.1 (x86)
            - Ð¡Ð±Ð¾Ñ€ÐºÐ° â„–: ${{ github.run_number }}
            - Ð”Ð°Ñ‚Ð° ÑÐ±Ð¾Ñ€ÐºÐ¸: ${{ steps.date.outputs.date }}
            
            ### ðŸ”— Ð¡ÑÑ‹Ð»ÐºÐ¸:
            - [Ð˜ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¹ ÐºÐ¾Ð´](https://github.com/${{ github.repository }})
            - [Ð¡Ð¾Ð¾Ð±Ñ‰Ð¸Ñ‚ÑŒ Ð¾Ð± Ð¾ÑˆÐ¸Ð±ÐºÐµ](https://github.com/${{ github.repository }}/issues)
            
            ---
            *Ð¡Ð¾Ð±Ñ€Ð°Ð½Ð¾: ${{ steps.date.outputs.date }}*
          draft: false
          prerelease: false